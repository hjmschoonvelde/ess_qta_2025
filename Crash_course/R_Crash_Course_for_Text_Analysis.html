<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="James Rice">

<title>R Crash Course for Text Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="R_Crash_Course_for_Text_Analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="R_Crash_Course_for_Text_Analysis_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="R_Crash_Course_for_Text_Analysis_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="R_Crash_Course_for_Text_Analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="R_Crash_Course_for_Text_Analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="R_Crash_Course_for_Text_Analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="R_Crash_Course_for_Text_Analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="R_Crash_Course_for_Text_Analysis_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="R_Crash_Course_for_Text_Analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="R_Crash_Course_for_Text_Analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="R_Crash_Course_for_Text_Analysis_files/libs/bootstrap/bootstrap-81267100e462c21b3d6c0d5bf76a3417.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#r-and-rstudio" id="toc-r-and-rstudio" class="nav-link active" data-scroll-target="#r-and-rstudio">R and RStudio</a></li>
  <li><a href="#some-basics-before-we-start" id="toc-some-basics-before-we-start" class="nav-link" data-scroll-target="#some-basics-before-we-start">Some basics before we start</a></li>
  <li><a href="#basic-operations-in-r" id="toc-basic-operations-in-r" class="nav-link" data-scroll-target="#basic-operations-in-r">Basic operations in R</a>
  <ul class="collapse">
  <li><a href="#functions-in-text-analysis" id="toc-functions-in-text-analysis" class="nav-link" data-scroll-target="#functions-in-text-analysis">Functions in Text Analysis</a></li>
  </ul></li>
  <li><a href="#data-types-in-r-for-text-analysis" id="toc-data-types-in-r-for-text-analysis" class="nav-link" data-scroll-target="#data-types-in-r-for-text-analysis">Data types in R for Text Analysis</a></li>
  <li><a href="#assigning-values-to-r-objects-for-text-analysis" id="toc-assigning-values-to-r-objects-for-text-analysis" class="nav-link" data-scroll-target="#assigning-values-to-r-objects-for-text-analysis">Assigning values to R objects for Text Analysis</a></li>
  <li><a href="#logical-expressions-for-text-filtering" id="toc-logical-expressions-for-text-filtering" class="nav-link" data-scroll-target="#logical-expressions-for-text-filtering">Logical Expressions for Text Filtering</a></li>
  <li><a href="#types-of-objects-in-r-for-text-analysis" id="toc-types-of-objects-in-r-for-text-analysis" class="nav-link" data-scroll-target="#types-of-objects-in-r-for-text-analysis">Types of objects in R for Text Analysis</a>
  <ul class="collapse">
  <li><a href="#vectors-for-text-collections" id="toc-vectors-for-text-collections" class="nav-link" data-scroll-target="#vectors-for-text-collections">Vectors for Text Collections</a>
  <ul class="collapse">
  <li><a href="#indices-and-subsetting-for-text-data" id="toc-indices-and-subsetting-for-text-data" class="nav-link" data-scroll-target="#indices-and-subsetting-for-text-data">Indices and subsetting for Text Data</a></li>
  </ul></li>
  <li><a href="#matrices-for-structured-text-data" id="toc-matrices-for-structured-text-data" class="nav-link" data-scroll-target="#matrices-for-structured-text-data">Matrices for Structured Text Data</a></li>
  <li><a href="#data-frames-for-text-analysis-datasets" id="toc-data-frames-for-text-analysis-datasets" class="nav-link" data-scroll-target="#data-frames-for-text-analysis-datasets">Data frames for Text Analysis Datasets</a></li>
  <li><a href="#lists-for-complex-text-analysis-results" id="toc-lists-for-complex-text-analysis-results" class="nav-link" data-scroll-target="#lists-for-complex-text-analysis-results">Lists for Complex Text Analysis Results</a></li>
  </ul></li>
  <li><a href="#data-management-for-text-analysis" id="toc-data-management-for-text-analysis" class="nav-link" data-scroll-target="#data-management-for-text-analysis">Data Management for Text Analysis</a>
  <ul class="collapse">
  <li><a href="#managing-workspace-and-setting-working-directory" id="toc-managing-workspace-and-setting-working-directory" class="nav-link" data-scroll-target="#managing-workspace-and-setting-working-directory">Managing workspace and setting working directory</a></li>
  </ul></li>
  <li><a href="#importing-and-managing-text-datasets" id="toc-importing-and-managing-text-datasets" class="nav-link" data-scroll-target="#importing-and-managing-text-datasets">Importing and managing text datasets</a>
  <ul class="collapse">
  <li><a href="#creating-new-text-analysis-variables" id="toc-creating-new-text-analysis-variables" class="nav-link" data-scroll-target="#creating-new-text-analysis-variables">Creating new text analysis variables</a></li>
  <li><a href="#basic-text-processing-operations" id="toc-basic-text-processing-operations" class="nav-link" data-scroll-target="#basic-text-processing-operations">Basic Text Processing Operations</a></li>
  </ul></li>
  <li><a href="#basic-statistical-analysis-and-regression" id="toc-basic-statistical-analysis-and-regression" class="nav-link" data-scroll-target="#basic-statistical-analysis-and-regression">Basic Statistical Analysis and Regression</a>
  <ul class="collapse">
  <li><a href="#descriptive-statistics" id="toc-descriptive-statistics" class="nav-link" data-scroll-target="#descriptive-statistics">Descriptive Statistics</a></li>
  <li><a href="#correlation-analysis" id="toc-correlation-analysis" class="nav-link" data-scroll-target="#correlation-analysis">Correlation Analysis</a></li>
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression">Linear Regression</a>
  <ul class="collapse">
  <li><a href="#simple-linear-regression" id="toc-simple-linear-regression" class="nav-link" data-scroll-target="#simple-linear-regression">Simple Linear Regression</a></li>
  <li><a href="#multiple-linear-regression" id="toc-multiple-linear-regression" class="nav-link" data-scroll-target="#multiple-linear-regression">Multiple Linear Regression</a></li>
  <li><a href="#model-diagnostics" id="toc-model-diagnostics" class="nav-link" data-scroll-target="#model-diagnostics">Model Diagnostics</a></li>
  <li><a href="#making-predictions" id="toc-making-predictions" class="nav-link" data-scroll-target="#making-predictions">Making Predictions</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#data-visualization-with-ggplot2" id="toc-data-visualization-with-ggplot2" class="nav-link" data-scroll-target="#data-visualization-with-ggplot2">Data Visualization with ggplot2</a>
  <ul class="collapse">
  <li><a href="#basic-ggplot2-syntax" id="toc-basic-ggplot2-syntax" class="nav-link" data-scroll-target="#basic-ggplot2-syntax">Basic ggplot2 Syntax</a></li>
  <li><a href="#common-plot-types" id="toc-common-plot-types" class="nav-link" data-scroll-target="#common-plot-types">Common Plot Types</a>
  <ul class="collapse">
  <li><a href="#scatter-plots" id="toc-scatter-plots" class="nav-link" data-scroll-target="#scatter-plots">Scatter Plots</a></li>
  <li><a href="#bar-charts" id="toc-bar-charts" class="nav-link" data-scroll-target="#bar-charts">Bar Charts</a></li>
  <li><a href="#histograms-and-density-plots" id="toc-histograms-and-density-plots" class="nav-link" data-scroll-target="#histograms-and-density-plots">Histograms and Density Plots</a></li>
  <li><a href="#box-plots" id="toc-box-plots" class="nav-link" data-scroll-target="#box-plots">Box Plots</a></li>
  </ul></li>
  <li><a href="#customizing-plots" id="toc-customizing-plots" class="nav-link" data-scroll-target="#customizing-plots">Customizing Plots</a>
  <ul class="collapse">
  <li><a href="#themes-and-styling" id="toc-themes-and-styling" class="nav-link" data-scroll-target="#themes-and-styling">Themes and Styling</a></li>
  <li><a href="#faceting-multiple-panels" id="toc-faceting-multiple-panels" class="nav-link" data-scroll-target="#faceting-multiple-panels">Faceting (Multiple Panels)</a></li>
  </ul></li>
  <li><a href="#working-with-text-analysis-data" id="toc-working-with-text-analysis-data" class="nav-link" data-scroll-target="#working-with-text-analysis-data">Working with Text Analysis Data</a></li>
  <li><a href="#text-specific-visualizations" id="toc-text-specific-visualizations" class="nav-link" data-scroll-target="#text-specific-visualizations">Text-Specific Visualizations</a></li>
  <li><a href="#saving-plots" id="toc-saving-plots" class="nav-link" data-scroll-target="#saving-plots">Saving Plots</a></li>
  </ul></li>
  <li><a href="#final-notes" id="toc-final-notes" class="nav-link" data-scroll-target="#final-notes">Final notes</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">R Crash Course for Text Analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>James Rice </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>This is a crash course in R with a focus on text analysis applications. It will give you an idea on how R works and introduce you to key concepts for analyzing textual data.</p>
<section id="r-and-rstudio" class="level1">
<h1>R and RStudio</h1>
<p><strong>R</strong> is an open-source programming language for statistical computing and graphics, with exceptional capabilities for text analysis and natural language processing.</p>
<p>Most of the functionalities of R come through <em>packages</em>, some of which are built-in within base R and many of which are community-provided (see <a href="http://www.cran.r-project.org">CRAN</a> for add-on packages). For text analysis, key packages include <code>stringr</code>, <code>tidytext</code>, <code>tm</code>, <code>quanteda</code>, and <code>textdata</code>.</p>
<p><strong>RStudio</strong> is an integrated development environment, a user-friendly interface for us to work with R. To use it locally on your computer, you need to first <a href="http://www.cran.r-project.org">install R</a> and then <a href="https://www.rstudio.com/products/rstudio/download/">RStudio</a>.</p>
<p>Both RStudio Desktop and RStudio Cloud has the same interface:</p>
<ol type="1">
<li>A window to edit code scripts on top-left.</li>
<li>A window to see the execution and outputs of commands on bottom-left.</li>
<li>A window to see the <em>environment</em>: objects in temporary memory, on top-right.</li>
<li>A window with several tabs: file directory, plots, R packages, and help files, on bottom-right.</li>
</ol>
</section>
<section id="some-basics-before-we-start" class="level1">
<h1>Some basics before we start</h1>
<ul>
<li>Any text following a ‚Äú#‚Äù is a comment and R ignores comments while executing the code
<ul>
<li>You will see comments very often in R scripts: These can be explanations, for your colleagues or for your future-self!</li>
</ul></li>
<li>R executes codes line by line. In RStudio, you can:
<ul>
<li>Click ‚ÄúRun‚Äù in the editor window.</li>
<li>Select a bulk of code and click ‚ÄúRun‚Äù to execute several lines of code.</li>
<li>Type and enter the code in the console.</li>
</ul></li>
</ul>
</section>
<section id="basic-operations-in-r" class="level1">
<h1>Basic operations in R</h1>
<p>While text analysis often involves complex operations, we still need to understand basic R operations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic arithmetic (useful for counting words, calculating frequencies, etc.)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>  <span class="co"># addition and subtraction</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> pi     <span class="co"># multiplication with constants</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.283185</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span><span class="sc">^</span><span class="dv">3</span>        <span class="co"># powers - useful for statistical calculations</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 27</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="dv">16</span>)   <span class="co"># square root function</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="dv">1</span>)     <span class="co"># natural logarithm (base = e)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Operations particularly useful for text analysis</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span> <span class="sc">/</span> <span class="dv">2</span>      <span class="co"># division - useful for calculating proportions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span> <span class="sc">%/%</span> <span class="dv">2</span>    <span class="co"># integer division - getting whole number results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span> <span class="sc">%%</span> <span class="dv">2</span>     <span class="co"># modulo - useful for sampling every nth item</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="dv">3000000000000</span> <span class="co"># scientific notation - useful for large text corpora</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3e+12</code></pre>
</div>
</div>
<section id="functions-in-text-analysis" class="level2">
<h2 class="anchored" data-anchor-id="functions-in-text-analysis">Functions in Text Analysis</h2>
<p>In text analysis, functions are essential for processing and manipulating textual data. Many specialized functions exist in base R and text analysis packages.</p>
<p>For text analysis, we frequently use functions like <code>str_length()</code>, <code>str_detect()</code>, <code>str_extract()</code> from the <code>stringr</code> package. Let‚Äôs see some basic examples:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic text processing functions</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>text_sample <span class="ot">&lt;-</span> <span class="st">"This is a sample text for analysis"</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nchar</span>(text_sample)  <span class="co"># count characters (base R function)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 34</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tolower</span>(text_sample) <span class="co"># convert to lowercase for standardization</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "this is a sample text for analysis"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">toupper</span>(text_sample) <span class="co"># convert to uppercase for emphasis</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "THIS IS A SAMPLE TEXT FOR ANALYSIS"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using stringr functions (more powerful for text analysis)</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)  <span class="co"># load the stringr package for advanced text processing</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str_length</span>(text_sample)  <span class="co"># count characters (stringr version)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 34</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(text_sample, <span class="st">"sample"</span>)  <span class="co"># detect if pattern exists (returns TRUE/FALSE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>Functions in R have a common format: function name followed by parentheses. Between parentheses are the input given by us to the function: these input can be text data, patterns to search for, or specifications for the function to run. We call the inputs as <em>arguments</em> of a function.</p>
<p>To inspect how a function works, and what are the arguments needed, we can use the <strong>help</strong> pages of these functions. Every function in R has a help page and a detailed document. These are very important and even people with advanced knowledge of R refer to these help pages very often. To access the help page, we can type the function name without parentheses and with a question mark in front of it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>?str_detect  <span class="co"># open help page for string detection function</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>?nchar       <span class="co"># open help page for character counting function</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Running this code opens the help page on the bottom-right window of RStudio. These help pages sometimes can be overwhelming, but in time you will get used to it and be able to find the information you need. The most important sections in the help page are,</p>
<ol type="1">
<li>Description: What the function does</li>
<li>Usage: How should the function be typed</li>
<li>Arguments: Inputs</li>
<li>Value: The output</li>
<li>Examples</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Functions are also objects in R. You can write your own function, store it and use it - this is particularly useful for custom text processing tasks.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Using multiple functions: An output of a function can be the input of another function (like f(g(x)) in math). R will evaluate these starting from the innermost function, going outside step by step.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This may be confusing in complex operations. Therefore the developers of R came with an alternative, the pipeline: <code>%&gt;%</code>. Pipeline operator takes the output of the code on its left hand side, and gives it as an input to the code on its right hand side (Pipeline does not exist in base R and we need extra packages to use it).</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Traditional nested approach</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tolower</span>(<span class="fu">str_replace_all</span>(text_sample, <span class="st">"[!?.]"</span>, <span class="st">""</span>))  <span class="co"># nested functions (hard to read)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "this is a sample text for analysis"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pipeline approach (much cleaner for text processing)</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>text_sample <span class="sc">%&gt;%</span>   <span class="co"># take text_sample and pass it to next function</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(<span class="st">"[!?.]"</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span>  <span class="co"># remove basic punctuation</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tolower</span>()       <span class="co"># then convert to lowercase</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "this is a sample text for analysis"</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>When you don‚Äôt know the name of a function and are looking for text analysis solutions, asking ChatGPT or Claude is the most effective way to find a solution. Prompts asking about ‚ÄúR text mining‚Äù, ‚ÄúR string manipulation‚Äù, or ‚ÄúR regex‚Äù are good starting points for general guidance.</p>
</div>
</div>
</section>
</section>
<section id="data-types-in-r-for-text-analysis" class="level1">
<h1>Data types in R for Text Analysis</h1>
<p>Understanding data types is crucial for text analysis, as we work with different types of textual information:</p>
<ol type="1">
<li><strong>Characters (Strings)</strong>: The most important data type for text analysis
<ol type="1">
<li>Can be inside either single or double quote.</li>
<li>If a string includes quotation marks, either a single quote can be used within double quote (or vice versa) or backlashes <code>\</code> can be used as an <em>escape</em> character</li>
<li>Text data often contains special characters, punctuation, and various encodings</li>
</ol></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="st">"This is a tweet about climate change"</span>    <span class="co"># basic string with double quotes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "This is a tweet about climate change"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="st">'Another text with "quotes" inside'</span>       <span class="co"># single quotes allow double quotes inside</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Another text with \"quotes\" inside"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="st">"Text with 'single quotes' inside"</span>        <span class="co"># double quotes allow single quotes inside</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Text with 'single quotes' inside"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="st">'Text with </span><span class="sc">\'</span><span class="st">escaped</span><span class="sc">\'</span><span class="st"> quotes'</span>            <span class="co"># escape characters allow same quote type inside</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Text with 'escaped' quotes"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Text with special characters common in social media</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>tweet_text <span class="ot">&lt;-</span> <span class="st">"Climate change is real! üåç #ClimateAction @UN"</span>  <span class="co"># emojis, hashtags, mentions</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tweet_text)  <span class="co"># display the text with special characters</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Climate change is real! üåç #ClimateAction @UN"</code></pre>
</div>
</div>
<ol start="2" type="1">
<li><strong>Numbers</strong>: Important for text analysis metrics (word counts, sentiment scores, frequencies)</li>
<li><strong>Logical</strong>: <code>TRUE</code> or <code>FALSE</code> with capital letters. <code>T</code> or <code>F</code> is also ok, but not preferred. Essential for filtering text data.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examples relevant to text analysis</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>word_count <span class="ot">&lt;-</span> <span class="dv">150</span>  <span class="co"># number of words in a document (integer)</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>sentiment_score <span class="ot">&lt;-</span> <span class="fl">0.75</span>  <span class="co"># sentiment analysis score (decimal between 0-1)</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>contains_keyword <span class="ot">&lt;-</span> <span class="cn">TRUE</span>  <span class="co"># whether text contains a specific keyword (logical)</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(word_count)      <span class="co"># check the data type of word_count</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(sentiment_score) <span class="co"># check the data type of sentiment_score  </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(contains_keyword) <span class="co"># check the data type of contains_keyword</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "logical"</code></pre>
</div>
</div>
<ol start="4" type="1">
<li><strong>Factors (Categories)</strong>: Useful for categorical text data like topics, sentiment categories, or document types</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Text categories</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>document_types <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"tweet"</span>, <span class="st">"news"</span>, <span class="st">"blog"</span>, <span class="st">"tweet"</span>, <span class="st">"news"</span>))  <span class="co"># create categorical variable</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>sentiment_categories <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"positive"</span>, <span class="st">"negative"</span>, <span class="st">"neutral"</span>, <span class="st">"positive"</span>))  <span class="co"># sentiment labels</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(document_types)  <span class="co"># show the unique categories in document_types</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "blog"  "news"  "tweet"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(document_types)   <span class="co"># count frequency of each document type</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>document_types
 blog  news tweet 
    1     2     2 </code></pre>
</div>
</div>
</section>
<section id="assigning-values-to-r-objects-for-text-analysis" class="level1">
<h1>Assigning values to R objects for Text Analysis</h1>
<p>R is an object-oriented programming language. We can create objects of different classes, assign values to them, edit and manipulate these objects. This is particularly important in text analysis where we often store and manipulate large collections of text data.</p>
<p>The assignment operator is: <code>&lt;-</code>. Shortcut: Option + ‚Äú-‚Äù in MacOS, Alt + ‚Äú-‚Äù in Windows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Storing text data in objects</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>my_text <span class="ot">&lt;-</span> <span class="st">"Climate change affects global weather patterns"</span>  <span class="co"># assign text to variable</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>tweet_content <span class="ot">&lt;-</span> <span class="st">"Just read an amazing article about renewable energy! #GreenTech"</span>  <span class="co"># social media text</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Check what we stored</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>my_text       <span class="co"># display the stored text</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Climate change affects global weather patterns"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>tweet_content <span class="co"># display the tweet content</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Just read an amazing article about renewable energy! #GreenTech"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can use objects in text processing operations </span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_length</span>(my_text)           <span class="co"># count characters in stored text</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 46</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_count</span>(tweet_content, <span class="st">"#"</span>) <span class="co"># count hashtags in tweet</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># When we assign a new value to an existing object, it overwrites it!</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>my_text <span class="ot">&lt;-</span> <span class="st">"Updated text about environmental policy"</span>  <span class="co"># overwrite previous value</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>my_text  <span class="co"># display the new content</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Updated text about environmental policy"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Storing different types of text analysis results</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>word_count <span class="ot">&lt;-</span> <span class="fu">str_count</span>(my_text, <span class="st">"</span><span class="sc">\\</span><span class="st">w+"</span>)  <span class="co"># count words using regex pattern</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(word_count)  <span class="co"># check data type of word count result</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>contains_policy <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(my_text, <span class="st">"policy"</span>)  <span class="co"># check for keyword presence</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(contains_policy)  <span class="co"># check data type of logical result</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "logical"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Store multiple related texts</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>climate_texts <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Global warming is accelerating"</span>,    <span class="co"># create vector of related texts</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Renewable energy adoption is increasing"</span>,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Carbon emissions must be reduced"</span>)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(climate_texts)  <span class="co"># check data type of text vector</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
</div>
</section>
<section id="logical-expressions-for-text-filtering" class="level1">
<h1>Logical Expressions for Text Filtering</h1>
<p>Statements that produce logical outcomes, i.e.&nbsp;<code>TRUE</code> or <code>FALSE</code> outcomes, are essential for filtering and analyzing text data. Main logical operators are below:</p>
<p>== equal to</p>
<p>!= not equal to</p>
<p>&gt; greater than</p>
<p>&lt; less than</p>
<p>&gt;= greater than or equal to</p>
<p>&lt;= less than or equal to</p>
<p>| or</p>
<p>&amp; and</p>
<p>! not</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic logical operations</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">&lt;</span> <span class="dv">2</span>   <span class="co"># less than comparison</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">==</span> <span class="dv">2</span>  <span class="co"># equality comparison  </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span>(<span class="dv">1</span> <span class="sc">==</span> <span class="dv">2</span>)  <span class="co"># negation of equality</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="sc">&lt;</span> <span class="dv">7</span> <span class="sc">&amp;</span> <span class="dv">7</span> <span class="sc">&lt;</span> <span class="dv">6</span>  <span class="co"># AND operation (both conditions must be true)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="sc">&lt;</span> <span class="dv">7</span> <span class="sc">|</span> <span class="dv">7</span> <span class="sc">&lt;</span> <span class="dv">6</span>  <span class="co"># OR operation (either condition can be true)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Text analysis applications</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>text1 <span class="ot">&lt;-</span> <span class="st">"climate change"</span>  <span class="co"># first text string</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>text2 <span class="ot">&lt;-</span> <span class="st">"global warming"</span>  <span class="co"># second text string</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare text strings</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>text1 <span class="sc">==</span> text2  <span class="co"># check if texts are identical</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>text1 <span class="sc">!=</span> text2  <span class="co"># check if texts are different</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check text length</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_length</span>(text1) <span class="sc">&gt;</span> <span class="dv">10</span>                    <span class="co"># is text1 longer than 10 characters?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_length</span>(text1) <span class="sc">&gt;=</span> <span class="fu">str_length</span>(text2)    <span class="co"># is text1 at least as long as text2?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine logical operations for text filtering</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>long_text <span class="ot">&lt;-</span> <span class="fu">str_length</span>(text1) <span class="sc">&gt;</span> <span class="dv">5</span>         <span class="co"># check if text is long enough</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>contains_climate <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(text1, <span class="st">"climate"</span>)  <span class="co"># check if text contains keyword</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Both conditions must be true</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>long_text <span class="sc">&amp;</span> contains_climate  <span class="co"># text must be long AND contain "climate"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Either condition can be true</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(text1, <span class="st">"weather"</span>) <span class="sc">|</span> <span class="fu">str_detect</span>(text1, <span class="st">"climate"</span>)  <span class="co"># contains "weather" OR "climate"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Text doesn't contain specific word</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span><span class="fu">str_detect</span>(text1, <span class="st">"economics"</span>)  <span class="co"># does NOT contain "economics"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="types-of-objects-in-r-for-text-analysis" class="level1">
<h1>Types of objects in R for Text Analysis</h1>
<p>Almost everything in R is an object: functions, plots, dataframes, and text collections.</p>
<p>Here we will focus on 4 main types of objects that text data are commonly stored in: 1. Vectors (collections of texts) 2. Matrices (structured text data) 3. Data frames (most common for text analysis datasets) 4. Lists (flexible storage for complex text analysis results)</p>
<section id="vectors-for-text-collections" class="level2">
<h2 class="anchored" data-anchor-id="vectors-for-text-collections">Vectors for Text Collections</h2>
<p>A vector is a one-dimensional object that can contain different values of same data type. For text analysis, character vectors are extremely important as they store collections of texts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create vectors of text data</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>tweets <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Love the new climate policy! #GreenFuture"</span>,  <span class="co"># first tweet</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Renewable energy is the way forward"</span>,        <span class="co"># second tweet</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Electric vehicles are becoming mainstream"</span>,   <span class="co"># third tweet</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Solar panels on every roof!"</span>)                <span class="co"># fourth tweet</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>news_headlines <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Global Temperature Rises to Record High"</span>,  <span class="co"># first headline</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"New Solar Technology Breakthrough"</span>,         <span class="co"># second headline</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"UN Climate Summit Begins Tomorrow"</span>)         <span class="co"># third headline</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>tweets          <span class="co"># display all tweets</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Love the new climate policy! #GreenFuture"
[2] "Renewable energy is the way forward"      
[3] "Electric vehicles are becoming mainstream"
[4] "Solar panels on every roof!"              </code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>news_headlines  <span class="co"># display all headlines</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Global Temperature Rises to Record High"
[2] "New Solar Technology Breakthrough"      
[3] "UN Climate Summit Begins Tomorrow"      </code></pre>
</div>
</div>
<p>To create longer vectors with patterns, there are shortcuts we can use, particularly useful for generating IDs or labels:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate document IDs</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>doc_ids <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"doc_"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)  <span class="co"># create IDs like "doc_1", "doc_2", etc.</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>doc_ids</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "doc_1"  "doc_2"  "doc_3"  "doc_4"  "doc_5"  "doc_6"  "doc_7"  "doc_8" 
 [9] "doc_9"  "doc_10"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate time periods</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="dv">2020</span><span class="sc">:</span><span class="dv">2024</span>  <span class="co"># create sequence of years</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>years</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2020 2021 2022 2023 2024</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeat categories (useful for labeling text data)</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>text_sources <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"twitter"</span>, <span class="st">"news"</span>, <span class="st">"blog"</span>), <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>))  <span class="co"># repeat each source specified number of times</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>text_sources</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "twitter" "twitter" "twitter" "news"    "news"    "blog"    "blog"   
[8] "blog"    "blog"   </code></pre>
</div>
</div>
<p>We can use some functions to extract information and attributes of a text vector:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(tweets)  <span class="co"># how many texts do we have in tweets vector?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(news_headlines)  <span class="co"># how many headlines do we have?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(tweets)      <span class="co"># what type of data is tweets?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(text_sources) <span class="co"># what type of data is text_sources?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Text-specific vector operations</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_length</span>(tweets)          <span class="co"># character count for each text in vector</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 41 35 41 27</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_count</span>(tweets, <span class="st">"</span><span class="sc">\\</span><span class="st">w+"</span>)   <span class="co"># word count for each text using regex pattern</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6 6 5 5</code></pre>
</div>
</div>
<section id="indices-and-subsetting-for-text-data" class="level3">
<h3 class="anchored" data-anchor-id="indices-and-subsetting-for-text-data">Indices and subsetting for Text Data</h3>
<p>We can access certain elements of a text vector using square brackets <code>[]</code>. We can use numbers as indices or logical expressions. This is crucial for filtering texts based on content or other criteria.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>tweets[<span class="dv">2</span>] <span class="co"># extract second tweet from vector</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Renewable energy is the way forward"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>news_headlines[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="co"># extract first two headlines using range</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Global Temperature Rises to Record High"
[2] "New Solar Technology Breakthrough"      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>tweets[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)] <span class="co"># extract first and fourth tweet using specific positions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Love the new climate policy! #GreenFuture"
[2] "Solar panels on every roof!"              </code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Logical filtering based on text content</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>long_tweets <span class="ot">&lt;-</span> <span class="fu">str_length</span>(tweets) <span class="sc">&gt;</span> <span class="dv">30</span> <span class="co"># create logical vector: which tweets are longer than 30 characters?</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>long_tweets</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE  TRUE  TRUE FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>tweets[long_tweets] <span class="co"># extract only the tweets that are longer than 30 characters</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Love the new climate policy! #GreenFuture"
[2] "Renewable energy is the way forward"      
[3] "Electric vehicles are becoming mainstream"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter texts containing specific keywords</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>climate_mentions <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(tweets, <span class="st">"climate|renewable|green"</span>)  <span class="co"># check which tweets mention climate terms</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>climate_mentions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE FALSE FALSE FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>tweets[climate_mentions] <span class="co"># extract texts mentioning climate-related terms</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Love the new climate policy! #GreenFuture"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can also assign new values to selected elements </span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>tweets_copy <span class="ot">&lt;-</span> tweets  <span class="co"># create copy to preserve original</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>tweets_copy[<span class="fu">str_detect</span>(tweets_copy, <span class="st">"#"</span>)] <span class="ot">&lt;-</span> <span class="fu">str_remove_all</span>(tweets_copy[<span class="fu">str_detect</span>(tweets_copy, <span class="st">"#"</span>)], <span class="st">"#</span><span class="sc">\\</span><span class="st">w+"</span>)  <span class="co"># remove hashtags from tweets containing them</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>tweets_copy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Love the new climate policy! "            
[2] "Renewable energy is the way forward"      
[3] "Electric vehicles are becoming mainstream"
[4] "Solar panels on every roof!"              </code></pre>
</div>
</div>
</section>
</section>
<section id="matrices-for-structured-text-data" class="level2">
<h2 class="anchored" data-anchor-id="matrices-for-structured-text-data">Matrices for Structured Text Data</h2>
<p>A matrix can be thought as a two dimensional vector, with rows and columns. In text analysis, matrices are often used for document-term matrices, where rows represent documents and columns represent words or features.</p>
<p>We can access values in a matrix using <code>[,]</code>. Comma here separates row and column information.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a simple word frequency matrix</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Rows = documents, Columns = words</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>word_freq_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">2</span>,    <span class="co"># doc1: frequencies for each word</span></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">1</span>,    <span class="co"># doc2: frequencies for each word  </span></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">3</span>),   <span class="co"># doc3: frequencies for each word</span></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">nrow =</span> <span class="dv">3</span>,      <span class="co"># specify number of rows (documents)</span></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="dv">4</span>,      <span class="co"># specify number of columns (words)</span></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">byrow =</span> <span class="cn">TRUE</span>)  <span class="co"># fill matrix row by row</span></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Add meaningful names</span></span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(word_freq_matrix) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"doc1"</span>, <span class="st">"doc2"</span>, <span class="st">"doc3"</span>)  <span class="co"># name the documents</span></span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(word_freq_matrix) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"climate"</span>, <span class="st">"change"</span>, <span class="st">"energy"</span>, <span class="st">"policy"</span>)  <span class="co"># name the words</span></span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a>word_freq_matrix  <span class="co"># display the matrix with names</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     climate change energy policy
doc1       5      3      0      2
doc2       2      1      4      1
doc3       0      0      6      3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Access specific elements</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>word_freq_matrix[<span class="dv">2</span>, <span class="dv">3</span>] <span class="co"># get frequency of "energy" in doc2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>word_freq_matrix[<span class="dv">2</span>, ] <span class="co"># get all word frequencies for doc2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>climate  change  energy  policy 
      2       1       4       1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>word_freq_matrix[, <span class="st">"climate"</span>] <span class="co"># get "climate" frequencies across all documents</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>doc1 doc2 doc3 
   5    2    0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>word_freq_matrix[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="fu">c</span>(<span class="st">"climate"</span>, <span class="st">"energy"</span>)] <span class="co"># get subset of documents and words</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     climate energy
doc1       5      0
doc2       2      4</code></pre>
</div>
</div>
<p>In text analysis, we often work with very large, sparse matrices (mostly zeros) representing document-term relationships.</p>
</section>
<section id="data-frames-for-text-analysis-datasets" class="level2">
<h2 class="anchored" data-anchor-id="data-frames-for-text-analysis-datasets">Data frames for Text Analysis Datasets</h2>
<p>When doing text analysis in R, most of the time we will be dealing with data frames. Data frames have columns as variables, and each row is an observation. In text analysis, each row typically represents a document, post, tweet, or other text unit, with columns for the text content, metadata, and analysis results.</p>
<p>We can create a data frame using <code>data.frame()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a text analysis dataset</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>text_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">doc_id =</span> <span class="fu">paste0</span>(<span class="st">"doc_"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>),  <span class="co"># create unique document IDs</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="fu">c</span>(<span class="st">"Climate change is a global crisis requiring immediate action"</span>,     <span class="co"># document texts</span></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Renewable energy sources are becoming more affordable"</span>,</span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Electric vehicles will transform transportation"</span>,</span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Carbon taxes could reduce emissions effectively"</span>,</span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Solar panels are now cheaper than fossil fuels"</span>, </span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Wind power generates clean electricity"</span>,</span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Green technology creates new job opportunities"</span>,</span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Environmental policies need stronger enforcement"</span>),</span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">source =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"news"</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">"policy"</span>, <span class="dv">2</span>), <span class="fu">rep</span>(<span class="st">"blog"</span>, <span class="dv">3</span>)),  <span class="co"># categorize document sources</span></span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">"2024-01-15"</span>, <span class="st">"2024-01-16"</span>, <span class="st">"2024-01-17"</span>, <span class="st">"2024-01-18"</span>,  <span class="co"># convert strings to date objects</span></span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"2024-01-19"</span>, <span class="st">"2024-01-20"</span>, <span class="st">"2024-01-21"</span>, <span class="st">"2024-01-22"</span>)),</span>
<span id="cb142-15"><a href="#cb142-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">word_count =</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="st">"Climate change is a global crisis requiring immediate action"</span>,  <span class="co"># count words in each text</span></span>
<span id="cb142-16"><a href="#cb142-16" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Renewable energy sources are becoming more affordable"</span>,</span>
<span id="cb142-17"><a href="#cb142-17" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Electric vehicles will transform transportation"</span>,</span>
<span id="cb142-18"><a href="#cb142-18" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Carbon taxes could reduce emissions effectively"</span>,</span>
<span id="cb142-19"><a href="#cb142-19" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Solar panels are now cheaper than fossil fuels"</span>, </span>
<span id="cb142-20"><a href="#cb142-20" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Wind power generates clean electricity"</span>,</span>
<span id="cb142-21"><a href="#cb142-21" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Green technology creates new job opportunities"</span>,</span>
<span id="cb142-22"><a href="#cb142-22" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Environmental policies need stronger enforcement"</span>), </span>
<span id="cb142-23"><a href="#cb142-23" aria-hidden="true" tabindex="-1"></a>                     <span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">strsplit</span>(x, <span class="st">" "</span>)[[<span class="dv">1</span>]]))  <span class="co"># basic word counting</span></span>
<span id="cb142-24"><a href="#cb142-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb142-25"><a href="#cb142-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-26"><a href="#cb142-26" aria-hidden="true" tabindex="-1"></a>text_df  <span class="co"># display the complete data frame</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                             doc_id
Climate change is a global crisis requiring immediate action  doc_1
Renewable energy sources are becoming more affordable         doc_2
Electric vehicles will transform transportation               doc_3
Carbon taxes could reduce emissions effectively               doc_4
Solar panels are now cheaper than fossil fuels                doc_5
Wind power generates clean electricity                        doc_6
Green technology creates new job opportunities                doc_7
Environmental policies need stronger enforcement              doc_8
                                                                                                                     text
Climate change is a global crisis requiring immediate action Climate change is a global crisis requiring immediate action
Renewable energy sources are becoming more affordable               Renewable energy sources are becoming more affordable
Electric vehicles will transform transportation                           Electric vehicles will transform transportation
Carbon taxes could reduce emissions effectively                           Carbon taxes could reduce emissions effectively
Solar panels are now cheaper than fossil fuels                             Solar panels are now cheaper than fossil fuels
Wind power generates clean electricity                                             Wind power generates clean electricity
Green technology creates new job opportunities                             Green technology creates new job opportunities
Environmental policies need stronger enforcement                         Environmental policies need stronger enforcement
                                                             source       date
Climate change is a global crisis requiring immediate action   news 2024-01-15
Renewable energy sources are becoming more affordable          news 2024-01-16
Electric vehicles will transform transportation                news 2024-01-17
Carbon taxes could reduce emissions effectively              policy 2024-01-18
Solar panels are now cheaper than fossil fuels               policy 2024-01-19
Wind power generates clean electricity                         blog 2024-01-20
Green technology creates new job opportunities                 blog 2024-01-21
Environmental policies need stronger enforcement               blog 2024-01-22
                                                             word_count
Climate change is a global crisis requiring immediate action          9
Renewable energy sources are becoming more affordable                 7
Electric vehicles will transform transportation                       5
Carbon taxes could reduce emissions effectively                       6
Solar panels are now cheaper than fossil fuels                        8
Wind power generates clean electricity                                5
Green technology creates new job opportunities                        6
Environmental policies need stronger enforcement                      5</code></pre>
</div>
</div>
<p>Each variable within our data frame is a vector, and the rules of vectors also apply to them. All variables in a data frame must have the same length. But we might have variables with missing values, depicted as <code>NA</code> in R.</p>
<p>We can use <code>$</code> operator to access individual columns/variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>text_df<span class="sc">$</span>text <span class="co"># access the text column using dollar sign notation</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Climate change is a global crisis requiring immediate action"
[2] "Renewable energy sources are becoming more affordable"       
[3] "Electric vehicles will transform transportation"             
[4] "Carbon taxes could reduce emissions effectively"             
[5] "Solar panels are now cheaper than fossil fuels"              
[6] "Wind power generates clean electricity"                      
[7] "Green technology creates new job opportunities"              
[8] "Environmental policies need stronger enforcement"            </code></pre>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note the different types of indexing extracting the same value</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>text_df<span class="sc">$</span>word_count[<span class="dv">3</span>]  <span class="co"># get word count for 3rd document using column name and position</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>text_df[<span class="dv">3</span>, <span class="dv">5</span>] <span class="co"># get 3rd row, 5th column using row and column numbers</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>text_df[<span class="dv">3</span>, <span class="st">"word_count"</span>] <span class="co"># get 3rd row, word_count column using row number and column name</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
</div>
<p>We can also subset the data frame using logical expressions - this is very common in text analysis for filtering documents:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter documents with more than 7 words</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>text_df[text_df<span class="sc">$</span>word_count <span class="sc">&gt;</span> <span class="dv">7</span>, ]  <span class="co"># subset rows where word count exceeds 7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                             doc_id
Climate change is a global crisis requiring immediate action  doc_1
Solar panels are now cheaper than fossil fuels                doc_5
                                                                                                                     text
Climate change is a global crisis requiring immediate action Climate change is a global crisis requiring immediate action
Solar panels are now cheaper than fossil fuels                             Solar panels are now cheaper than fossil fuels
                                                             source       date
Climate change is a global crisis requiring immediate action   news 2024-01-15
Solar panels are now cheaper than fossil fuels               policy 2024-01-19
                                                             word_count
Climate change is a global crisis requiring immediate action          9
Solar panels are now cheaper than fossil fuels                        8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter news articles only</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>text_df[text_df<span class="sc">$</span>source <span class="sc">==</span> <span class="st">"news"</span>, ]  <span class="co"># subset rows where source equals "news"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                             doc_id
Climate change is a global crisis requiring immediate action  doc_1
Renewable energy sources are becoming more affordable         doc_2
Electric vehicles will transform transportation               doc_3
                                                                                                                     text
Climate change is a global crisis requiring immediate action Climate change is a global crisis requiring immediate action
Renewable energy sources are becoming more affordable               Renewable energy sources are becoming more affordable
Electric vehicles will transform transportation                           Electric vehicles will transform transportation
                                                             source       date
Climate change is a global crisis requiring immediate action   news 2024-01-15
Renewable energy sources are becoming more affordable          news 2024-01-16
Electric vehicles will transform transportation                news 2024-01-17
                                                             word_count
Climate change is a global crisis requiring immediate action          9
Renewable energy sources are becoming more affordable                 7
Electric vehicles will transform transportation                       5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter texts containing "energy"</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>text_df[<span class="fu">str_detect</span>(text_df<span class="sc">$</span>text, <span class="st">"energy"</span>), ]  <span class="co"># subset rows where text contains "energy"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                      doc_id
Renewable energy sources are becoming more affordable  doc_2
                                                                                                       text
Renewable energy sources are becoming more affordable Renewable energy sources are becoming more affordable
                                                      source       date
Renewable energy sources are becoming more affordable   news 2024-01-16
                                                      word_count
Renewable energy sources are becoming more affordable          7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple conditions: news articles with more than 7 words</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>text_df[text_df<span class="sc">$</span>source <span class="sc">==</span> <span class="st">"news"</span> <span class="sc">&amp;</span> text_df<span class="sc">$</span>word_count <span class="sc">&gt;</span> <span class="dv">7</span>, ]  <span class="co"># combine multiple filtering conditions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                             doc_id
Climate change is a global crisis requiring immediate action  doc_1
                                                                                                                     text
Climate change is a global crisis requiring immediate action Climate change is a global crisis requiring immediate action
                                                             source       date
Climate change is a global crisis requiring immediate action   news 2024-01-15
                                                             word_count
Climate change is a global crisis requiring immediate action          9</code></pre>
</div>
</div>
</section>
<section id="lists-for-complex-text-analysis-results" class="level2">
<h2 class="anchored" data-anchor-id="lists-for-complex-text-analysis-results">Lists for Complex Text Analysis Results</h2>
<p>Lists are the most flexible object type in that they can include different types of other R objects, including other lists. In text analysis, lists are particularly useful for storing complex results like topic models, sentiment analysis outputs, or multiple datasets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a list containing different text analysis components</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>text_analysis_results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">raw_texts =</span> text_df,                    <span class="co"># store the complete data frame</span></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">word_frequency_matrix =</span> word_freq_matrix, <span class="co"># store the word frequency matrix</span></span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">summary_stats =</span> <span class="fu">c</span>(<span class="at">total_docs =</span> <span class="fu">nrow</span>(text_df),     <span class="co"># calculate and store summary statistics</span></span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">avg_word_count =</span> <span class="fu">mean</span>(text_df<span class="sc">$</span>word_count)),</span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">keywords =</span> <span class="fu">c</span>(<span class="st">"climate"</span>, <span class="st">"energy"</span>, <span class="st">"renewable"</span>, <span class="st">"carbon"</span>)  <span class="co"># store key terms of interest</span></span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a>text_analysis_results  <span class="co"># display the entire list structure</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$raw_texts
                                                             doc_id
Climate change is a global crisis requiring immediate action  doc_1
Renewable energy sources are becoming more affordable         doc_2
Electric vehicles will transform transportation               doc_3
Carbon taxes could reduce emissions effectively               doc_4
Solar panels are now cheaper than fossil fuels                doc_5
Wind power generates clean electricity                        doc_6
Green technology creates new job opportunities                doc_7
Environmental policies need stronger enforcement              doc_8
                                                                                                                     text
Climate change is a global crisis requiring immediate action Climate change is a global crisis requiring immediate action
Renewable energy sources are becoming more affordable               Renewable energy sources are becoming more affordable
Electric vehicles will transform transportation                           Electric vehicles will transform transportation
Carbon taxes could reduce emissions effectively                           Carbon taxes could reduce emissions effectively
Solar panels are now cheaper than fossil fuels                             Solar panels are now cheaper than fossil fuels
Wind power generates clean electricity                                             Wind power generates clean electricity
Green technology creates new job opportunities                             Green technology creates new job opportunities
Environmental policies need stronger enforcement                         Environmental policies need stronger enforcement
                                                             source       date
Climate change is a global crisis requiring immediate action   news 2024-01-15
Renewable energy sources are becoming more affordable          news 2024-01-16
Electric vehicles will transform transportation                news 2024-01-17
Carbon taxes could reduce emissions effectively              policy 2024-01-18
Solar panels are now cheaper than fossil fuels               policy 2024-01-19
Wind power generates clean electricity                         blog 2024-01-20
Green technology creates new job opportunities                 blog 2024-01-21
Environmental policies need stronger enforcement               blog 2024-01-22
                                                             word_count
Climate change is a global crisis requiring immediate action          9
Renewable energy sources are becoming more affordable                 7
Electric vehicles will transform transportation                       5
Carbon taxes could reduce emissions effectively                       6
Solar panels are now cheaper than fossil fuels                        8
Wind power generates clean electricity                                5
Green technology creates new job opportunities                        6
Environmental policies need stronger enforcement                      5

$word_frequency_matrix
     climate change energy policy
doc1       5      3      0      2
doc2       2      1      4      1
doc3       0      0      6      3

$summary_stats
    total_docs avg_word_count 
         8.000          6.375 

$keywords
[1] "climate"   "energy"    "renewable" "carbon"   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note the double square brackets as indices </span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>text_analysis_results[<span class="dv">1</span>] <span class="co"># returns a list containing the first element (still a list)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$raw_texts
                                                             doc_id
Climate change is a global crisis requiring immediate action  doc_1
Renewable energy sources are becoming more affordable         doc_2
Electric vehicles will transform transportation               doc_3
Carbon taxes could reduce emissions effectively               doc_4
Solar panels are now cheaper than fossil fuels                doc_5
Wind power generates clean electricity                        doc_6
Green technology creates new job opportunities                doc_7
Environmental policies need stronger enforcement              doc_8
                                                                                                                     text
Climate change is a global crisis requiring immediate action Climate change is a global crisis requiring immediate action
Renewable energy sources are becoming more affordable               Renewable energy sources are becoming more affordable
Electric vehicles will transform transportation                           Electric vehicles will transform transportation
Carbon taxes could reduce emissions effectively                           Carbon taxes could reduce emissions effectively
Solar panels are now cheaper than fossil fuels                             Solar panels are now cheaper than fossil fuels
Wind power generates clean electricity                                             Wind power generates clean electricity
Green technology creates new job opportunities                             Green technology creates new job opportunities
Environmental policies need stronger enforcement                         Environmental policies need stronger enforcement
                                                             source       date
Climate change is a global crisis requiring immediate action   news 2024-01-15
Renewable energy sources are becoming more affordable          news 2024-01-16
Electric vehicles will transform transportation                news 2024-01-17
Carbon taxes could reduce emissions effectively              policy 2024-01-18
Solar panels are now cheaper than fossil fuels               policy 2024-01-19
Wind power generates clean electricity                         blog 2024-01-20
Green technology creates new job opportunities                 blog 2024-01-21
Environmental policies need stronger enforcement               blog 2024-01-22
                                                             word_count
Climate change is a global crisis requiring immediate action          9
Renewable energy sources are becoming more affordable                 7
Electric vehicles will transform transportation                       5
Carbon taxes could reduce emissions effectively                       6
Solar panels are now cheaper than fossil fuels                        8
Wind power generates clean electricity                                5
Green technology creates new job opportunities                        6
Environmental policies need stronger enforcement                      5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>text_analysis_results[[<span class="dv">1</span>]] <span class="co"># returns the actual data frame (extracts content)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                             doc_id
Climate change is a global crisis requiring immediate action  doc_1
Renewable energy sources are becoming more affordable         doc_2
Electric vehicles will transform transportation               doc_3
Carbon taxes could reduce emissions effectively               doc_4
Solar panels are now cheaper than fossil fuels                doc_5
Wind power generates clean electricity                        doc_6
Green technology creates new job opportunities                doc_7
Environmental policies need stronger enforcement              doc_8
                                                                                                                     text
Climate change is a global crisis requiring immediate action Climate change is a global crisis requiring immediate action
Renewable energy sources are becoming more affordable               Renewable energy sources are becoming more affordable
Electric vehicles will transform transportation                           Electric vehicles will transform transportation
Carbon taxes could reduce emissions effectively                           Carbon taxes could reduce emissions effectively
Solar panels are now cheaper than fossil fuels                             Solar panels are now cheaper than fossil fuels
Wind power generates clean electricity                                             Wind power generates clean electricity
Green technology creates new job opportunities                             Green technology creates new job opportunities
Environmental policies need stronger enforcement                         Environmental policies need stronger enforcement
                                                             source       date
Climate change is a global crisis requiring immediate action   news 2024-01-15
Renewable energy sources are becoming more affordable          news 2024-01-16
Electric vehicles will transform transportation                news 2024-01-17
Carbon taxes could reduce emissions effectively              policy 2024-01-18
Solar panels are now cheaper than fossil fuels               policy 2024-01-19
Wind power generates clean electricity                         blog 2024-01-20
Green technology creates new job opportunities                 blog 2024-01-21
Environmental policies need stronger enforcement               blog 2024-01-22
                                                             word_count
Climate change is a global crisis requiring immediate action          9
Renewable energy sources are becoming more affordable                 7
Electric vehicles will transform transportation                       5
Carbon taxes could reduce emissions effectively                       6
Solar panels are now cheaper than fossil fuels                        8
Wind power generates clean electricity                                5
Green technology creates new job opportunities                        6
Environmental policies need stronger enforcement                      5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Access specific elements within list components</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>text_analysis_results[[<span class="dv">1</span>]][<span class="dv">2</span>, <span class="st">"text"</span>] <span class="co"># get second text from the raw_texts data frame</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Renewable energy sources are becoming more affordable"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>text_analysis_results[[<span class="dv">4</span>]][<span class="dv">1</span>] <span class="co"># get first keyword from keywords vector</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "climate"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lists can store results from text analysis functions</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>sample_analysis <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">corpus_size =</span> <span class="fu">length</span>(tweets),                                    <span class="co"># count total number of tweets</span></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">vocabulary =</span> <span class="fu">unique</span>(<span class="fu">unlist</span>(<span class="fu">strsplit</span>(<span class="fu">paste</span>(tweets, <span class="at">collapse =</span> <span class="st">" "</span>), <span class="st">" "</span>))),  <span class="co"># extract unique words (basic method)</span></span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">longest_tweet =</span> <span class="fu">max</span>(<span class="fu">str_length</span>(tweets))                          <span class="co"># find length of longest tweet</span></span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a>sample_analysis  <span class="co"># display the analysis results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$corpus_size
[1] 4

$vocabulary
 [1] "Love"         "the"          "new"          "climate"      "policy!"     
 [6] "#GreenFuture" "Renewable"    "energy"       "is"           "way"         
[11] "forward"      "Electric"     "vehicles"     "are"          "becoming"    
[16] "mainstream"   "Solar"        "panels"       "on"           "every"       
[21] "roof!"       

$longest_tweet
[1] 41</code></pre>
</div>
</div>
</section>
</section>
<section id="data-management-for-text-analysis" class="level1">
<h1>Data Management for Text Analysis</h1>
<section id="managing-workspace-and-setting-working-directory" class="level2">
<h2 class="anchored" data-anchor-id="managing-workspace-and-setting-working-directory">Managing workspace and setting working directory</h2>
<p>When working with text analysis in R, we often read text files (like CSV files with social media data, PDFs, or plain text documents) and produce outputs as files (such as cleaned datasets, word clouds, or analysis results).</p>
<p>When R reads and writes such files, it works in a pre-specified location in our folder directory, called <strong>working directory</strong>.</p>
<p>From the settings of RStudio, we can set a default working directory. But as we need to work on different text analysis projects, it is better to set working directory to the folder we are using for the individual project to keep things tidy. This is also very useful when sharing text analysis code with collaborators.</p>
<p>To see where our current working directory is, we can run <code>getwd()</code> command. To change the working directory we use <code>setwd("file path here")</code> command.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check current working directory</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "/Users/jameskrice"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To set working directory to a specific folder, use:</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("path/to/your/project/folder")</span></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a><span class="co"># For example:</span></span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("~/Documents/R-projects/text-analysis")  # Mac/Linux</span></span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("C:/Users/YourName/Documents/R-projects/text-analysis")  # Windows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="importing-and-managing-text-datasets" class="level1">
<h1>Importing and managing text datasets</h1>
<p>We can import text data from a variety of file types using functions built for each data file type. Text data commonly comes from CSV files (social media exports), JSON files (API responses), or plain text files.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read a dataset (assuming we have a text dataset)</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="co"># dat &lt;- read.csv("social_media_posts.csv")  # example of reading real CSV file</span></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a><span class="co"># For demonstration, let's create a sample dataset</span></span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a>social_media <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">post_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,    <span class="co"># create sequential post IDs</span></span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">platform =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"twitter"</span>, <span class="st">"facebook"</span>, <span class="st">"instagram"</span>), <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),  <span class="co"># randomly assign platforms</span></span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">text_content =</span> <span class="fu">paste</span>(<span class="st">"Sample post about"</span>,   <span class="co"># create sample text content</span></span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"climate change"</span>, <span class="st">"renewable energy"</span>, <span class="st">"sustainability"</span>, </span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"carbon emissions"</span>, <span class="st">"green technology"</span>), <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">engagement =</span> <span class="fu">sample</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">1000</span>, <span class="dv">100</span>),  <span class="co"># randomly assign engagement scores</span></span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>            <span class="co"># keep text as character (not factor)</span></span>
<span id="cb175-13"><a href="#cb175-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb175-14"><a href="#cb175-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-15"><a href="#cb175-15" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(social_media) <span class="co"># display first six posts for preview</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  post_id  platform                       text_content engagement
1       1   twitter Sample post about green technology        508
2       2  facebook Sample post about green technology        912
3       3 instagram Sample post about carbon emissions        768
4       4   twitter   Sample post about sustainability        906
5       5   twitter   Sample post about sustainability        610
6       6 instagram   Sample post about sustainability        317</code></pre>
</div>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(social_media) <span class="co"># show structure of our text dataset</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   100 obs. of  4 variables:
 $ post_id     : int  1 2 3 4 5 6 7 8 9 10 ...
 $ platform    : chr  "twitter" "facebook" "instagram" "twitter" ...
 $ text_content: chr  "Sample post about green technology" "Sample post about green technology" "Sample post about carbon emissions" "Sample post about sustainability" ...
 $ engagement  : int  508 912 768 906 610 317 354 504 607 617 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's subset posts with high engagement (&gt;500)</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>high_engagement <span class="ot">&lt;-</span> social_media[social_media<span class="sc">$</span>engagement <span class="sc">&gt;</span> <span class="dv">500</span>, ]  <span class="co"># filter high engagement posts</span></span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Three ways to filter text data (all equivalent)</span></span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Method 1: base R with square brackets</span></span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a>climate_posts1 <span class="ot">&lt;-</span> social_media[<span class="fu">str_detect</span>(social_media<span class="sc">$</span>text_content, <span class="st">"climate"</span>), ]  <span class="co"># base R filtering</span></span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Method 2: base R subset() function  </span></span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true" tabindex="-1"></a>climate_posts2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(social_media, <span class="fu">str_detect</span>(text_content, <span class="st">"climate"</span>))  <span class="co"># subset function</span></span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-11"><a href="#cb179-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Method 3: dplyr filter() function (preferred for readability)</span></span>
<span id="cb179-12"><a href="#cb179-12" aria-hidden="true" tabindex="-1"></a>climate_posts3 <span class="ot">&lt;-</span> <span class="fu">filter</span>(social_media, <span class="fu">str_detect</span>(text_content, <span class="st">"climate"</span>))  <span class="co"># dplyr filtering</span></span>
<span id="cb179-13"><a href="#cb179-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-14"><a href="#cb179-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if results are identical</span></span>
<span id="cb179-15"><a href="#cb179-15" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(climate_posts1<span class="sc">$</span>post_id <span class="sc">==</span> climate_posts2<span class="sc">$</span>post_id)  <span class="co"># compare method 1 and 2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(climate_posts1<span class="sc">$</span>post_id <span class="sc">==</span> climate_posts3<span class="sc">$</span>post_id)  <span class="co"># compare method 1 and 3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>As all three filtering methods produce identical results, we don‚Äôt need to keep all of them in memory. <code>rm()</code> function removes objects from the environment. If we want to remove all objects from the environment (i.e.&nbsp;clean up the workspace), we can do it with a single command: <code>rm(list=ls())</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(climate_posts2, climate_posts3)  <span class="co"># remove duplicate objects to free up memory</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Above, we filtered rows using text content. Sometimes we need to select specific columns for text analysis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only relevant columns for text analysis</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>text_only <span class="ot">&lt;-</span> social_media[, <span class="fu">c</span>(<span class="st">"post_id"</span>, <span class="st">"text_content"</span>, <span class="st">"platform"</span>)]  <span class="co"># base R column selection</span></span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Using subset() function</span></span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>text_subset1 <span class="ot">&lt;-</span> <span class="fu">subset</span>(social_media, <span class="at">select =</span> <span class="fu">c</span>(post_id, text_content, platform))  <span class="co"># subset function selection</span></span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Using dplyr select() function  </span></span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a>text_subset2 <span class="ot">&lt;-</span> <span class="fu">select</span>(social_media, post_id, text_content, platform)  <span class="co"># dplyr selection</span></span>
<span id="cb184-9"><a href="#cb184-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-10"><a href="#cb184-10" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(text_only<span class="sc">$</span>post_id <span class="sc">==</span> text_subset1<span class="sc">$</span>post_id)  <span class="co"># verify methods produce identical results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(text_only<span class="sc">$</span>post_id <span class="sc">==</span> text_subset2<span class="sc">$</span>post_id)  <span class="co"># verify methods produce identical results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(text_subset1, text_subset2)  <span class="co"># clean up duplicate objects</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>unique()</code> function is particularly useful in text analysis for exploring categorical variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># See which platforms are in our dataset</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(social_media<span class="sc">$</span>platform)  <span class="co"># get unique platform names</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "twitter"   "facebook"  "instagram"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count unique platforms</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(social_media<span class="sc">$</span>platform))  <span class="co"># count number of unique platforms</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get unique words across all posts (basic tokenization)</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>all_words <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">str_split</span>(social_media<span class="sc">$</span>text_content, <span class="st">"</span><span class="sc">\\</span><span class="st">s+"</span>))  <span class="co"># split all posts into individual words</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>unique_words <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">tolower</span>(all_words))  <span class="co"># get unique words in lowercase</span></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(unique_words, <span class="dv">20</span>) <span class="co"># display first 20 unique words</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "sample"         "post"           "about"          "green"         
 [5] "technology"     "carbon"         "emissions"      "sustainability"
 [9] "climate"        "change"         "renewable"      "energy"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vocabulary size</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(unique_words)  <span class="co"># count total unique words in dataset</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12</code></pre>
</div>
</div>
<section id="creating-new-text-analysis-variables" class="level2">
<h2 class="anchored" data-anchor-id="creating-new-text-analysis-variables">Creating new text analysis variables</h2>
<p>Text analysis often involves creating new variables based on text content. Let‚Äôs create several useful text metrics:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic text metrics</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>social_media<span class="sc">$</span>char_count <span class="ot">&lt;-</span> <span class="fu">str_length</span>(social_media<span class="sc">$</span>text_content)        <span class="co"># count characters in each post</span></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>social_media<span class="sc">$</span>word_count <span class="ot">&lt;-</span> <span class="fu">sapply</span>(social_media<span class="sc">$</span>text_content, <span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">strsplit</span>(x, <span class="st">" "</span>)[[<span class="dv">1</span>]]))  <span class="co"># count words (basic method)</span></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Using mutate() from dplyr (preferred approach)</span></span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>social_media <span class="ot">&lt;-</span> social_media <span class="sc">%&gt;%</span></span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">contains_climate =</span> <span class="fu">str_detect</span>(text_content, <span class="st">"climate"</span>),   <span class="co"># detect climate mentions</span></span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">contains_energy =</span> <span class="fu">str_detect</span>(text_content, <span class="st">"energy"</span>)     <span class="co"># detect energy mentions</span></span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-12"><a href="#cb197-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(social_media)  <span class="co"># display first few rows with new variables</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  post_id  platform                       text_content engagement char_count
1       1   twitter Sample post about green technology        508         34
2       2  facebook Sample post about green technology        912         34
3       3 instagram Sample post about carbon emissions        768         34
4       4   twitter   Sample post about sustainability        906         32
5       5   twitter   Sample post about sustainability        610         32
6       6 instagram   Sample post about sustainability        317         32
  word_count contains_climate contains_energy
1          5            FALSE           FALSE
2          5            FALSE           FALSE
3          5            FALSE           FALSE
4          4            FALSE           FALSE
5          4            FALSE           FALSE
6          4            FALSE           FALSE</code></pre>
</div>
</div>
<p>Creating categorical variables based on text content using <code>ifelse()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create topic categories based on keywords</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>social_media<span class="sc">$</span>topic_category <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_detect</span>(social_media<span class="sc">$</span>text_content, <span class="st">"climate"</span>), <span class="st">"Climate"</span>,        <span class="co"># if contains "climate"</span></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(social_media<span class="sc">$</span>text_content, <span class="st">"energy"</span>), <span class="st">"Energy"</span>,   <span class="co"># else if contains "energy" </span></span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(social_media<span class="sc">$</span>text_content, <span class="st">"green"</span>), <span class="st">"Green"</span>, <span class="st">"Other"</span>)) <span class="co"># else if "green", else other</span></span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create engagement level categories</span></span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a>social_media<span class="sc">$</span>engagement_level <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true" tabindex="-1"></a>  social_media<span class="sc">$</span>engagement <span class="sc">&gt;</span> <span class="dv">500</span>, <span class="st">"High"</span>, <span class="st">"Low"</span>)                       <span class="co"># simple high vs low engagement</span></span>
<span id="cb199-11"><a href="#cb199-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-12"><a href="#cb199-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Explore our categorizations</span></span>
<span id="cb199-13"><a href="#cb199-13" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(social_media<span class="sc">$</span>topic_category)    <span class="co"># count posts by topic category</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Climate  Energy   Green   Other 
     15      16      16      53 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(social_media<span class="sc">$</span>engagement_level)  <span class="co"># count posts by engagement level</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
High  Low 
  52   48 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-tabulation: topic by engagement level</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(social_media<span class="sc">$</span>topic_category, social_media<span class="sc">$</span>engagement_level)  <span class="co"># cross-tabulate categories</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         
          High Low
  Climate    6   9
  Energy     6  10
  Green     12   4
  Other     28  25</code></pre>
</div>
</div>
</section>
<section id="basic-text-processing-operations" class="level2">
<h2 class="anchored" data-anchor-id="basic-text-processing-operations">Basic Text Processing Operations</h2>
<p>Here are some essential text processing operations commonly used in text analysis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample texts for processing</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>sample_texts <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Climate Change is URGENT! We need action NOW!"</span>,      <span class="co"># text with caps and punctuation</span></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"renewable energy is the future for our planet"</span>,      <span class="co"># text with lowercase</span></span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"CARBON emissions must be reduced by 50% soon"</span>        <span class="co"># text with numbers and caps</span></span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Text cleaning operations</span></span>
<span id="cb205-9"><a href="#cb205-9" aria-hidden="true" tabindex="-1"></a>cleaned_texts <span class="ot">&lt;-</span> sample_texts <span class="sc">%&gt;%</span></span>
<span id="cb205-10"><a href="#cb205-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_to_lower</span>() <span class="sc">%&gt;%</span>                    <span class="co"># convert all text to lowercase</span></span>
<span id="cb205-11"><a href="#cb205-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_remove_all</span>(<span class="st">"[!?.]"</span>) <span class="sc">%&gt;%</span>           <span class="co"># remove basic punctuation</span></span>
<span id="cb205-12"><a href="#cb205-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_squish</span>()                          <span class="co"># remove extra whitespace (multiple spaces become single)</span></span>
<span id="cb205-13"><a href="#cb205-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-14"><a href="#cb205-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare original and cleaned</span></span>
<span id="cb205-15"><a href="#cb205-15" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">original =</span> sample_texts, <span class="at">cleaned =</span> cleaned_texts)  <span class="co"># side-by-side comparison</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                       original
1 Climate Change is URGENT! We need action NOW!
2 renewable energy is the future for our planet
3  CARBON emissions must be reduced by 50% soon
                                        cleaned
1   climate change is urgent we need action now
2 renewable energy is the future for our planet
3  carbon emissions must be reduced by 50% soon</code></pre>
</div>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic pattern detection</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>has_caps <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(sample_texts, <span class="st">"[A-Z]"</span>)          <span class="co"># detect if text has capital letters</span></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>has_caps</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE FALSE  TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>has_numbers <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(sample_texts, <span class="st">"[0-9]"</span>)       <span class="co"># detect if text has numbers  </span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>has_numbers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE FALSE  TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Word tokenization (splitting text into words)</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>words_list <span class="ot">&lt;-</span> <span class="fu">str_split</span>(cleaned_texts, <span class="st">" "</span>)            <span class="co"># split each text into individual words</span></span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>words_list</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "climate" "change"  "is"      "urgent"  "we"      "need"    "action" 
[8] "now"    

[[2]]
[1] "renewable" "energy"    "is"        "the"       "future"    "for"      
[7] "our"       "planet"   

[[3]]
[1] "carbon"    "emissions" "must"      "be"        "reduced"   "by"       
[7] "50%"       "soon"     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Flatten to single vector of all words</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>all_words <span class="ot">&lt;-</span> <span class="fu">unlist</span>(words_list)                        <span class="co"># combine all word lists into single vector</span></span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>word_frequencies <span class="ot">&lt;-</span> <span class="fu">table</span>(all_words)                  <span class="co"># count frequency of each word</span></span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(word_frequencies, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)             <span class="co"># sort word frequencies from highest to lowest</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>all_words
       is       50%    action        be        by    carbon    change   climate 
        2         1         1         1         1         1         1         1 
emissions    energy       for    future      must      need       now       our 
        1         1         1         1         1         1         1         1 
   planet   reduced renewable      soon       the    urgent        we 
        1         1         1         1         1         1         1 </code></pre>
</div>
</div>
</section>
</section>
<section id="basic-statistical-analysis-and-regression" class="level1">
<h1>Basic Statistical Analysis and Regression</h1>
<p>One of R‚Äôs greatest strengths is its statistical capabilities. Here we‚Äôll learn how to perform basic descriptive statistics and regression analysis.</p>
<section id="descriptive-statistics" class="level2">
<h2 class="anchored" data-anchor-id="descriptive-statistics">Descriptive Statistics</h2>
<p>R provides many built-in functions for descriptive statistics:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the built-in mtcars dataset for examples</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mtcars)  <span class="co"># load the built-in cars dataset</span></span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtcars)  <span class="co"># display first six rows of data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic descriptive statistics</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(mtcars<span class="sc">$</span>mpg)    <span class="co"># calculate average miles per gallon</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20.09062</code></pre>
</div>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(mtcars<span class="sc">$</span>mpg)  <span class="co"># calculate median miles per gallon</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(mtcars<span class="sc">$</span>mpg)      <span class="co"># calculate standard deviation of mpg</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.026948</code></pre>
</div>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(mtcars<span class="sc">$</span>mpg)     <span class="co"># calculate variance of mpg</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 36.3241</code></pre>
</div>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(mtcars<span class="sc">$</span>mpg)     <span class="co"># find minimum mpg value</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(mtcars<span class="sc">$</span>mpg)     <span class="co"># find maximum mpg value</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 33.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(mtcars<span class="sc">$</span>mpg)   <span class="co"># get both min and max values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.4 33.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics for all variables</span></span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mtcars)     <span class="co"># get summary stats for entire dataset</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      mpg             cyl             disp             hp       
 Min.   :10.40   Min.   :4.000   Min.   : 71.1   Min.   : 52.0  
 1st Qu.:15.43   1st Qu.:4.000   1st Qu.:120.8   1st Qu.: 96.5  
 Median :19.20   Median :6.000   Median :196.3   Median :123.0  
 Mean   :20.09   Mean   :6.188   Mean   :230.7   Mean   :146.7  
 3rd Qu.:22.80   3rd Qu.:8.000   3rd Qu.:326.0   3rd Qu.:180.0  
 Max.   :33.90   Max.   :8.000   Max.   :472.0   Max.   :335.0  
      drat             wt             qsec             vs        
 Min.   :2.760   Min.   :1.513   Min.   :14.50   Min.   :0.0000  
 1st Qu.:3.080   1st Qu.:2.581   1st Qu.:16.89   1st Qu.:0.0000  
 Median :3.695   Median :3.325   Median :17.71   Median :0.0000  
 Mean   :3.597   Mean   :3.217   Mean   :17.85   Mean   :0.4375  
 3rd Qu.:3.920   3rd Qu.:3.610   3rd Qu.:18.90   3rd Qu.:1.0000  
 Max.   :4.930   Max.   :5.424   Max.   :22.90   Max.   :1.0000  
       am              gear            carb      
 Min.   :0.0000   Min.   :3.000   Min.   :1.000  
 1st Qu.:0.0000   1st Qu.:3.000   1st Qu.:2.000  
 Median :0.0000   Median :4.000   Median :2.000  
 Mean   :0.4062   Mean   :3.688   Mean   :2.812  
 3rd Qu.:1.0000   3rd Qu.:4.000   3rd Qu.:4.000  
 Max.   :1.0000   Max.   :5.000   Max.   :8.000  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For specific variables</span></span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mtcars<span class="sc">$</span>mpg) <span class="co"># detailed summary for mpg variable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  10.40   15.43   19.20   20.09   22.80   33.90 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mtcars<span class="sc">$</span>cyl) <span class="co"># detailed summary for cylinders variable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  4.000   4.000   6.000   6.188   8.000   8.000 </code></pre>
</div>
</div>
</section>
<section id="correlation-analysis" class="level2">
<h2 class="anchored" data-anchor-id="correlation-analysis">Correlation Analysis</h2>
<p>Understanding relationships between variables is crucial in data analysis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation between two variables</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(mtcars<span class="sc">$</span>mpg, mtcars<span class="sc">$</span>wt)  <span class="co"># calculate correlation between mpg and weight</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.8676594</code></pre>
</div>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation matrix for multiple variables</span></span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(mtcars[, <span class="fu">c</span>(<span class="st">"mpg"</span>, <span class="st">"wt"</span>, <span class="st">"hp"</span>, <span class="st">"qsec"</span>)])  <span class="co"># correlations between selected variables</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            mpg         wt         hp       qsec
mpg   1.0000000 -0.8676594 -0.7761684  0.4186840
wt   -0.8676594  1.0000000  0.6587479 -0.1747159
hp   -0.7761684  0.6587479  1.0000000 -0.7082234
qsec  0.4186840 -0.1747159 -0.7082234  1.0000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a correlation matrix for all numeric variables</span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(mtcars)           <span class="co"># calculate all pairwise correlations</span></span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(cor_matrix, <span class="dv">2</span>)                <span class="co"># round to 2 decimal places for readability</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
mpg   1.00 -0.85 -0.85 -0.78  0.68 -0.87  0.42  0.66  0.60  0.48 -0.55
cyl  -0.85  1.00  0.90  0.83 -0.70  0.78 -0.59 -0.81 -0.52 -0.49  0.53
disp -0.85  0.90  1.00  0.79 -0.71  0.89 -0.43 -0.71 -0.59 -0.56  0.39
hp   -0.78  0.83  0.79  1.00 -0.45  0.66 -0.71 -0.72 -0.24 -0.13  0.75
drat  0.68 -0.70 -0.71 -0.45  1.00 -0.71  0.09  0.44  0.71  0.70 -0.09
wt   -0.87  0.78  0.89  0.66 -0.71  1.00 -0.17 -0.55 -0.69 -0.58  0.43
qsec  0.42 -0.59 -0.43 -0.71  0.09 -0.17  1.00  0.74 -0.23 -0.21 -0.66
vs    0.66 -0.81 -0.71 -0.72  0.44 -0.55  0.74  1.00  0.17  0.21 -0.57
am    0.60 -0.52 -0.59 -0.24  0.71 -0.69 -0.23  0.17  1.00  0.79  0.06
gear  0.48 -0.49 -0.56 -0.13  0.70 -0.58 -0.21  0.21  0.79  1.00  0.27
carb -0.55  0.53  0.39  0.75 -0.09  0.43 -0.66 -0.57  0.06  0.27  1.00</code></pre>
</div>
</div>
</section>
<section id="linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression">Linear Regression</h2>
<p>Linear regression is one of the most fundamental statistical techniques. In R, we use the <code>lm()</code> function (linear model) to fit regression models.</p>
<section id="simple-linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="simple-linear-regression">Simple Linear Regression</h3>
<p>Let‚Äôs examine the relationship between car weight and fuel efficiency:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a simple linear regression model</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mpg (dependent variable) ~ wt (independent variable)</span></span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> wt, <span class="at">data =</span> mtcars)  <span class="co"># create linear model: mpg depends on weight</span></span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a><span class="co"># View the results</span></span>
<span id="cb243-6"><a href="#cb243-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)  <span class="co"># display comprehensive model results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ wt, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5432 -2.3647 -0.1252  1.4096  6.8727 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  37.2851     1.8776  19.858  &lt; 2e-16 ***
wt           -5.3445     0.5591  -9.559 1.29e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.046 on 30 degrees of freedom
Multiple R-squared:  0.7528,    Adjusted R-squared:  0.7446 
F-statistic: 91.38 on 1 and 30 DF,  p-value: 1.294e-10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract specific components</span></span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coefficients</span>(model1)  <span class="co"># get regression coefficients (intercept and slope)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          wt 
  37.285126   -5.344472 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(model1)        <span class="co"># get predicted values for each observation</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Mazda RX4       Mazda RX4 Wag          Datsun 710      Hornet 4 Drive 
          23.282611           21.919770           24.885952           20.102650 
  Hornet Sportabout             Valiant          Duster 360           Merc 240D 
          18.900144           18.793255           18.205363           20.236262 
           Merc 230            Merc 280           Merc 280C          Merc 450SE 
          20.450041           18.900144           18.900144           15.533127 
         Merc 450SL         Merc 450SLC  Cadillac Fleetwood Lincoln Continental 
          17.350247           17.083024            9.226650            8.296712 
  Chrysler Imperial            Fiat 128         Honda Civic      Toyota Corolla 
           8.718926           25.527289           28.653805           27.478021 
      Toyota Corona    Dodge Challenger         AMC Javelin          Camaro Z28 
          24.111004           18.472586           18.926866           16.762355 
   Pontiac Firebird           Fiat X1-9       Porsche 914-2        Lotus Europa 
          16.735633           26.943574           25.847957           29.198941 
     Ford Pantera L        Ferrari Dino       Maserati Bora          Volvo 142E 
          20.343151           22.480940           18.205363           22.427495 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(model1)     <span class="co"># get residuals (actual - predicted values)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Mazda RX4       Mazda RX4 Wag          Datsun 710      Hornet 4 Drive 
         -2.2826106          -0.9197704          -2.0859521           1.2973499 
  Hornet Sportabout             Valiant          Duster 360           Merc 240D 
         -0.2001440          -0.6932545          -3.9053627           4.1637381 
           Merc 230            Merc 280           Merc 280C          Merc 450SE 
          2.3499593           0.2998560          -1.1001440           0.8668731 
         Merc 450SL         Merc 450SLC  Cadillac Fleetwood Lincoln Continental 
         -0.0502472          -1.8830236           1.1733496           2.1032876 
  Chrysler Imperial            Fiat 128         Honda Civic      Toyota Corolla 
          5.9810744           6.8727113           1.7461954           6.4219792 
      Toyota Corona    Dodge Challenger         AMC Javelin          Camaro Z28 
         -2.6110037          -2.9725862          -3.7268663          -3.4623553 
   Pontiac Firebird           Fiat X1-9       Porsche 914-2        Lotus Europa 
          2.4643670           0.3564263           0.1520430           1.2010593 
     Ford Pantera L        Ferrari Dino       Maserati Bora          Volvo 142E 
         -4.5431513          -2.7809399          -3.2053627          -1.0274952 </code></pre>
</div>
</div>
</section>
<section id="multiple-linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="multiple-linear-regression">Multiple Linear Regression</h3>
<p>We can include multiple predictors in our model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple regression with several predictors</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> wt <span class="sc">+</span> hp <span class="sc">+</span> cyl, <span class="at">data =</span> mtcars)  <span class="co"># model with weight, horsepower, and cylinders</span></span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)  <span class="co"># display results for multiple regression model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ wt + hp + cyl, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.9290 -1.5598 -0.5311  1.1850  5.8986 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 38.75179    1.78686  21.687  &lt; 2e-16 ***
wt          -3.16697    0.74058  -4.276 0.000199 ***
hp          -0.01804    0.01188  -1.519 0.140015    
cyl         -0.94162    0.55092  -1.709 0.098480 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.512 on 28 degrees of freedom
Multiple R-squared:  0.8431,    Adjusted R-squared:  0.8263 
F-statistic: 50.17 on 3 and 28 DF,  p-value: 2.184e-11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare models using ANOVA</span></span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model1, model2)  <span class="co"># statistical comparison between simple and multiple models</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: mpg ~ wt
Model 2: mpg ~ wt + hp + cyl
  Res.Df    RSS Df Sum of Sq      F   Pr(&gt;F)   
1     30 278.32                                
2     28 176.62  2     101.7 8.0615 0.001718 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="model-diagnostics" class="level3">
<h3 class="anchored" data-anchor-id="model-diagnostics">Model Diagnostics</h3>
<p>It‚Äôs important to check regression assumptions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic diagnostic plots</span></span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))  <span class="co"># arrange plots in 2x2 grid for comprehensive view</span></span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model2)          <span class="co"># create four standard diagnostic plots</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Crash_Course_for_Text_Analysis_files/figure-html/Tests-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))  <span class="co"># reset to single plot layout</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Additional diagnostics</span></span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for normality of residuals</span></span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(model2))  <span class="co"># test if residuals are normally distributed</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(model2)
W = 0.93455, p-value = 0.05252</code></pre>
</div>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for multicollinearity (if you have car package)</span></span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a><span class="co"># vif(model2)  # Variance Inflation Factor - uncomment if car package available</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="making-predictions" class="level3">
<h3 class="anchored" data-anchor-id="making-predictions">Making Predictions</h3>
<p>Once we have a fitted model, we can make predictions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict mpg for new data</span></span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">wt =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="fl">3.0</span>, <span class="fl">3.5</span>),   <span class="co"># create new weight values</span></span>
<span id="cb259-3"><a href="#cb259-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">hp =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>),     <span class="co"># create new horsepower values</span></span>
<span id="cb259-4"><a href="#cb259-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">cyl =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>))          <span class="co"># create new cylinder values</span></span>
<span id="cb259-5"><a href="#cb259-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-6"><a href="#cb259-6" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model2, <span class="at">newdata =</span> new_data)  <span class="co"># generate predictions for new data</span></span>
<span id="cb259-7"><a href="#cb259-7" aria-hidden="true" tabindex="-1"></a>predictions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2        3 
25.26408 20.89545 16.52683 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictions with confidence intervals</span></span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(model2, <span class="at">newdata =</span> new_data, <span class="at">interval =</span> <span class="st">"confidence"</span>)  <span class="co"># predictions with uncertainty bounds</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 25.26408 23.67315 26.85500
2 20.89545 19.92960 21.86131
3 16.52683 15.01760 18.03605</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="data-visualization-with-ggplot2" class="level1">
<h1>Data Visualization with ggplot2</h1>
<p><strong>ggplot2</strong> is one of the most powerful and popular packages for data visualization in R. It‚Äôs based on the ‚ÄúGrammar of Graphics‚Äù philosophy, which builds plots layer by layer.</p>
<section id="basic-ggplot2-syntax" class="level2">
<h2 class="anchored" data-anchor-id="basic-ggplot2-syntax">Basic ggplot2 Syntax</h2>
<p>The basic structure of a ggplot2 command is: - <code>ggplot(data, aes(x, y))</code> - sets up the plot with data and aesthetic mappings - <code>+ geom_*()</code> - adds geometric objects (points, lines, bars, etc.) - <code>+ additional layers</code> - adds titles, themes, etc.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load ggplot2 (already loaded in setup)</span></span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)  <span class="co"># load the ggplot2 package for visualization</span></span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic scatter plot</span></span>
<span id="cb263-5"><a href="#cb263-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="fu">aes</span>(<span class="at">x =</span> wt, <span class="at">y =</span> mpg)) <span class="sc">+</span>  <span class="co"># set up plot with data and aesthetics</span></span>
<span id="cb263-6"><a href="#cb263-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()  <span class="co"># add points to create scatter plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Crash_Course_for_Text_Analysis_files/figure-html/Ggplot2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="common-plot-types" class="level2">
<h2 class="anchored" data-anchor-id="common-plot-types">Common Plot Types</h2>
<section id="scatter-plots" class="level3">
<h3 class="anchored" data-anchor-id="scatter-plots">Scatter Plots</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Enhanced scatter plot with color and size</span></span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> wt, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(cyl), <span class="at">size =</span> hp)) <span class="sc">+</span>  <span class="co"># map cylinder to color, horsepower to size</span></span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Car Weight vs Fuel Efficiency"</span>,      <span class="co"># add descriptive title</span></span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Weight (1000 lbs)"</span>,                       <span class="co"># label x-axis</span></span>
<span id="cb264-6"><a href="#cb264-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Miles per Gallon"</span>,                        <span class="co"># label y-axis</span></span>
<span id="cb264-7"><a href="#cb264-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Cylinders"</span>,                           <span class="co"># label color legend</span></span>
<span id="cb264-8"><a href="#cb264-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">size =</span> <span class="st">"Horsepower"</span>)                           <span class="co"># label size legend</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Crash_Course_for_Text_Analysis_files/figure-html/Scatter%20plots-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a regression line</span></span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> wt, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span>                                      <span class="co"># add scatter points</span></span>
<span id="cb265-4"><a href="#cb265-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span>            <span class="co"># add linear regression line with confidence band</span></span>
<span id="cb265-5"><a href="#cb265-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Car Weight vs MPG with Regression Line"</span>)  <span class="co"># add title</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Crash_Course_for_Text_Analysis_files/figure-html/Scatter%20plots-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="bar-charts" class="level3">
<h3 class="anchored" data-anchor-id="bar-charts">Bar Charts</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar chart showing count of cars by cylinder</span></span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number of Cars by Cylinder Count"</span>,</span>
<span id="cb266-5"><a href="#cb266-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Number of Cylinders"</span>,</span>
<span id="cb266-6"><a href="#cb266-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Crash_Course_for_Text_Analysis_files/figure-html/Bar%20plots-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar chart with means</span></span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a>cyl_summary <span class="ot">&lt;-</span> mtcars <span class="sc">%&gt;%</span></span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">%&gt;%</span></span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_mpg =</span> <span class="fu">mean</span>(mpg))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar chart showing count of cars by cylinder</span></span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span>                                        <span class="co"># create bar chart counting observations</span></span>
<span id="cb268-4"><a href="#cb268-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number of Cars by Cylinder Count"</span>,   <span class="co"># add descriptive title</span></span>
<span id="cb268-5"><a href="#cb268-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Number of Cylinders"</span>,                     <span class="co"># label x-axis</span></span>
<span id="cb268-6"><a href="#cb268-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>)                                   <span class="co"># label y-axis</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Crash_Course_for_Text_Analysis_files/figure-html/More%20bar%20plots-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar chart with means</span></span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a>cyl_summary <span class="ot">&lt;-</span> mtcars <span class="sc">%&gt;%</span></span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">%&gt;%</span>                                   <span class="co"># group data by cylinder count</span></span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_mpg =</span> <span class="fu">mean</span>(mpg))                     <span class="co"># calculate mean mpg for each group</span></span>
<span id="cb269-5"><a href="#cb269-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-6"><a href="#cb269-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cyl_summary, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(cyl), <span class="at">y =</span> mean_mpg)) <span class="sc">+</span></span>
<span id="cb269-7"><a href="#cb269-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span>                      <span class="co"># create column chart with specified color</span></span>
<span id="cb269-8"><a href="#cb269-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average MPG by Cylinder Count"</span>,      <span class="co"># add title</span></span>
<span id="cb269-9"><a href="#cb269-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Number of Cylinders"</span>,                     <span class="co"># label x-axis</span></span>
<span id="cb269-10"><a href="#cb269-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average MPG"</span>)                             <span class="co"># label y-axis</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Crash_Course_for_Text_Analysis_files/figure-html/More%20bar%20plots-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="histograms-and-density-plots" class="level3">
<h3 class="anchored" data-anchor-id="histograms-and-density-plots">Histograms and Density Plots</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram</span></span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> mpg)) <span class="sc">+</span></span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">10</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span>  <span class="co"># create histogram with 10 bins</span></span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Miles per Gallon"</span>,                  <span class="co"># add title</span></span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Miles per Gallon"</span>,                                      <span class="co"># label x-axis</span></span>
<span id="cb270-6"><a href="#cb270-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>)                                             <span class="co"># label y-axis</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Crash_Course_for_Text_Analysis_files/figure-html/Histograms-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Density plot</span></span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> mpg)) <span class="sc">+</span></span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"orange"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span>                     <span class="co"># create density plot with transparency</span></span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Density Plot of Miles per Gallon"</span>)                 <span class="co"># add title</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Crash_Course_for_Text_Analysis_files/figure-html/Histograms-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Overlapping density plots by group</span></span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> mpg, <span class="at">fill =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span>                                      <span class="co"># create overlapping densities with transparency</span></span>
<span id="cb272-4"><a href="#cb272-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MPG Distribution by Cylinder Count"</span>,               <span class="co"># add title</span></span>
<span id="cb272-5"><a href="#cb272-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Cylinders"</span>)                                          <span class="co"># label fill legend</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Crash_Course_for_Text_Analysis_files/figure-html/Histograms-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="box-plots" class="level3">
<h3 class="anchored" data-anchor-id="box-plots">Box Plots</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plot</span></span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(cyl), <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightgreen"</span>) <span class="sc">+</span>                              <span class="co"># create box plot with fill color</span></span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MPG Distribution by Cylinder Count"</span>,               <span class="co"># add title</span></span>
<span id="cb273-5"><a href="#cb273-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Number of Cylinders"</span>,                                  <span class="co"># label x-axis</span></span>
<span id="cb273-6"><a href="#cb273-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Miles per Gallon"</span>)                                     <span class="co"># label y-axis</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Crash_Course_for_Text_Analysis_files/figure-html/Boxplots-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plot with individual points</span></span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(cyl), <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightgreen"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span>                <span class="co"># create semi-transparent box plot</span></span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span>                       <span class="co"># add jittered points to show individual data</span></span>
<span id="cb274-5"><a href="#cb274-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MPG Distribution by Cylinder Count (with data points)"</span>)  <span class="co"># add descriptive title</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Crash_Course_for_Text_Analysis_files/figure-html/Boxplots-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="customizing-plots" class="level2">
<h2 class="anchored" data-anchor-id="customizing-plots">Customizing Plots</h2>
<section id="themes-and-styling" class="level3">
<h3 class="anchored" data-anchor-id="themes-and-styling">Themes and Styling</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using different themes</span></span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> wt, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span>                          <span class="co"># create base plot with colored points</span></span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Weight vs MPG"</span>, <span class="at">color =</span> <span class="st">"Cylinders"</span>)              <span class="co"># add labels</span></span>
<span id="cb275-5"><a href="#cb275-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-6"><a href="#cb275-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Different theme options</span></span>
<span id="cb275-7"><a href="#cb275-7" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_minimal</span>()    <span class="co"># apply minimal theme (clean, minimal design)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Crash_Course_for_Text_Analysis_files/figure-html/Themes-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_classic</span>()    <span class="co"># apply classic theme (traditional look)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Crash_Course_for_Text_Analysis_files/figure-html/Themes-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_dark</span>()       <span class="co"># apply dark theme (dark background)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Crash_Course_for_Text_Analysis_files/figure-html/Themes-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom theme modifications</span></span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),       <span class="co"># center and resize title</span></span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)                               <span class="co"># move legend to bottom</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Crash_Course_for_Text_Analysis_files/figure-html/Themes-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="faceting-multiple-panels" class="level3">
<h3 class="anchored" data-anchor-id="faceting-multiple-panels">Faceting (Multiple Panels)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Facet by a categorical variable</span></span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> wt, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb279-3"><a href="#cb279-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span>                                                  <span class="co"># add scatter points</span></span>
<span id="cb279-4"><a href="#cb279-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>                       <span class="co"># add regression line without confidence band</span></span>
<span id="cb279-5"><a href="#cb279-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> cyl) <span class="sc">+</span>                                            <span class="co"># create separate panels for each cylinder count</span></span>
<span id="cb279-6"><a href="#cb279-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Weight vs MPG by Cylinder Count"</span>)                <span class="co"># add title</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Crash_Course_for_Text_Analysis_files/figure-html/Faceting-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Facet grid with two variables</span></span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> wt, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span>                                                  <span class="co"># add scatter points</span></span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(cyl <span class="sc">~</span> am) <span class="sc">+</span>                                         <span class="co"># create grid: cylinders on rows, transmission on columns</span></span>
<span id="cb280-5"><a href="#cb280-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Weight vs MPG by Cylinders and Transmission"</span>)    <span class="co"># add title</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Crash_Course_for_Text_Analysis_files/figure-html/Faceting-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="working-with-text-analysis-data" class="level2">
<h2 class="anchored" data-anchor-id="working-with-text-analysis-data">Working with Text Analysis Data</h2>
<p>Let‚Äôs apply our visualization skills to text analysis datasets:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualizations with our text analysis data</span></span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar chart of text sources</span></span>
<span id="cb281-3"><a href="#cb281-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(social_media, <span class="fu">aes</span>(<span class="at">x =</span> platform)) <span class="sc">+</span></span>
<span id="cb281-4"><a href="#cb281-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span>                                  <span class="co"># count posts by platform with blue bars</span></span>
<span id="cb281-5"><a href="#cb281-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number of Posts by Platform"</span>,                    <span class="co"># add title</span></span>
<span id="cb281-6"><a href="#cb281-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Platform"</span>,                                            <span class="co"># label x-axis</span></span>
<span id="cb281-7"><a href="#cb281-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Posts"</span>)                                     <span class="co"># label y-axis</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Crash_Course_for_Text_Analysis_files/figure-html/Visualizing%20text-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram of word counts</span></span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(social_media, <span class="fu">aes</span>(<span class="at">x =</span> word_count)) <span class="sc">+</span></span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">15</span>, <span class="at">fill =</span> <span class="st">"lightcoral"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span>  <span class="co"># create histogram of word counts</span></span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Word Counts in Posts"</span>,               <span class="co"># add title</span></span>
<span id="cb282-5"><a href="#cb282-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Word Count"</span>,                                              <span class="co"># label x-axis</span></span>
<span id="cb282-6"><a href="#cb282-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>)                                               <span class="co"># label y-axis</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Crash_Course_for_Text_Analysis_files/figure-html/Visualizing%20text-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plot of engagement by platform</span></span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(social_media, <span class="fu">aes</span>(<span class="at">x =</span> platform, <span class="at">y =</span> engagement)) <span class="sc">+</span></span>
<span id="cb283-3"><a href="#cb283-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span>                              <span class="co"># create box plots for engagement by platform</span></span>
<span id="cb283-4"><a href="#cb283-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Engagement Distribution by Platform"</span>,             <span class="co"># add title</span></span>
<span id="cb283-5"><a href="#cb283-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Platform"</span>,                                            <span class="co"># label x-axis</span></span>
<span id="cb283-6"><a href="#cb283-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Engagement"</span>)                                          <span class="co"># label y-axis</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Crash_Course_for_Text_Analysis_files/figure-html/Visualizing%20text-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot: word count vs engagement</span></span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(social_media, <span class="fu">aes</span>(<span class="at">x =</span> word_count, <span class="at">y =</span> engagement)) <span class="sc">+</span></span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> platform)) <span class="sc">+</span>                            <span class="co"># scatter plot with points colored by platform</span></span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>                       <span class="co"># add overall trend line</span></span>
<span id="cb284-5"><a href="#cb284-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Word Count vs Engagement by Platform"</span>,           <span class="co"># add title</span></span>
<span id="cb284-6"><a href="#cb284-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Word Count"</span>,                                          <span class="co"># label x-axis</span></span>
<span id="cb284-7"><a href="#cb284-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Engagement"</span>,                                          <span class="co"># label y-axis</span></span>
<span id="cb284-8"><a href="#cb284-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Platform"</span>)                                        <span class="co"># label color legend</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Crash_Course_for_Text_Analysis_files/figure-html/Visualizing%20text-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Faceted analysis by topic category</span></span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(social_media, <span class="fu">aes</span>(<span class="at">x =</span> word_count, <span class="at">y =</span> engagement)) <span class="sc">+</span></span>
<span id="cb285-3"><a href="#cb285-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> platform)) <span class="sc">+</span>                            <span class="co"># scatter plot with platform colors</span></span>
<span id="cb285-4"><a href="#cb285-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> topic_category) <span class="sc">+</span>                                 <span class="co"># separate panels for each topic</span></span>
<span id="cb285-5"><a href="#cb285-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Word Count vs Engagement by Topic Category"</span>,     <span class="co"># add title</span></span>
<span id="cb285-6"><a href="#cb285-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Word Count"</span>,                                          <span class="co"># label x-axis</span></span>
<span id="cb285-7"><a href="#cb285-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Engagement"</span>,                                          <span class="co"># label y-axis</span></span>
<span id="cb285-8"><a href="#cb285-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Platform"</span>)                                        <span class="co"># label color legend</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Crash_Course_for_Text_Analysis_files/figure-html/Visualizing%20text-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="text-specific-visualizations" class="level2">
<h2 class="anchored" data-anchor-id="text-specific-visualizations">Text-Specific Visualizations</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Word frequency visualization</span></span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a>word_freq_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">word =</span> <span class="fu">names</span>(word_frequencies),                                 <span class="co"># extract word names from frequency table</span></span>
<span id="cb286-4"><a href="#cb286-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">frequency =</span> <span class="fu">as.numeric</span>(word_frequencies)                       <span class="co"># convert frequencies to numeric</span></span>
<span id="cb286-5"><a href="#cb286-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb286-6"><a href="#cb286-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(frequency)) <span class="sc">%&gt;%</span>                                    <span class="co"># sort by frequency (highest first)</span></span>
<span id="cb286-7"><a href="#cb286-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)                                                        <span class="co"># keep only top 10 words</span></span>
<span id="cb286-8"><a href="#cb286-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-9"><a href="#cb286-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(word_freq_df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(word, frequency), <span class="at">y =</span> frequency)) <span class="sc">+</span></span>
<span id="cb286-10"><a href="#cb286-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"darkgreen"</span>) <span class="sc">+</span>                                  <span class="co"># create column chart with green bars</span></span>
<span id="cb286-11"><a href="#cb286-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span>                                                  <span class="co"># flip coordinates for horizontal bars</span></span>
<span id="cb286-12"><a href="#cb286-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Most Frequent Words"</span>,                     <span class="co"># add title</span></span>
<span id="cb286-13"><a href="#cb286-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Word"</span>,                                                <span class="co"># label x-axis (now vertical due to flip)</span></span>
<span id="cb286-14"><a href="#cb286-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>)                                           <span class="co"># label y-axis (now horizontal due to flip)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Crash_Course_for_Text_Analysis_files/figure-html/More%20text%20visualization-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Character count distribution by platform</span></span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(social_media, <span class="fu">aes</span>(<span class="at">x =</span> char_count, <span class="at">fill =</span> platform)) <span class="sc">+</span></span>
<span id="cb287-3"><a href="#cb287-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">position =</span> <span class="st">"identity"</span>, <span class="at">bins =</span> <span class="dv">20</span>) <span class="sc">+</span>  <span class="co"># overlapping histograms with transparency</span></span>
<span id="cb287-4"><a href="#cb287-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> platform) <span class="sc">+</span>                                         <span class="co"># separate panels for each platform</span></span>
<span id="cb287-5"><a href="#cb287-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Character Count Distribution by Platform"</span>,         <span class="co"># add title</span></span>
<span id="cb287-6"><a href="#cb287-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Character Count"</span>,                                       <span class="co"># label x-axis</span></span>
<span id="cb287-7"><a href="#cb287-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>,                                             <span class="co"># label y-axis</span></span>
<span id="cb287-8"><a href="#cb287-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Platform"</span>)                                           <span class="co"># label fill legend</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Crash_Course_for_Text_Analysis_files/figure-html/More%20text%20visualization-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Topic category distribution</span></span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a>topic_counts <span class="ot">&lt;-</span> social_media <span class="sc">%&gt;%</span></span>
<span id="cb288-3"><a href="#cb288-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(topic_category, <span class="at">sort =</span> <span class="cn">TRUE</span>)                               <span class="co"># count posts by topic and sort</span></span>
<span id="cb288-4"><a href="#cb288-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-5"><a href="#cb288-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(topic_counts, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(topic_category, n), <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb288-6"><a href="#cb288-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"purple"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span>                        <span class="co"># create column chart with purple bars</span></span>
<span id="cb288-7"><a href="#cb288-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span>                                                   <span class="co"># flip for horizontal bars</span></span>
<span id="cb288-8"><a href="#cb288-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Posts by Topic Category"</span>,         <span class="co"># add title</span></span>
<span id="cb288-9"><a href="#cb288-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Topic Category"</span>,                                       <span class="co"># label x-axis</span></span>
<span id="cb288-10"><a href="#cb288-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Posts"</span>)                                      <span class="co"># label y-axis</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_Crash_Course_for_Text_Analysis_files/figure-html/More%20text%20visualization-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="saving-plots" class="level2">
<h2 class="anchored" data-anchor-id="saving-plots">Saving Plots</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the last plot</span></span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"my_plot.png"</span>, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">dpi =</span> <span class="dv">300</span>)  <span class="co"># save most recent plot as PNG</span></span>
<span id="cb289-3"><a href="#cb289-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-4"><a href="#cb289-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Save a specific plot</span></span>
<span id="cb289-5"><a href="#cb289-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> wt, <span class="at">y =</span> mpg)) <span class="sc">+</span> <span class="fu">geom_point</span>()  <span class="co"># create and store plot object</span></span>
<span id="cb289-6"><a href="#cb289-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"scatter_plot.pdf"</span>, <span class="at">plot =</span> p, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>)  <span class="co"># save specific plot as PDF</span></span>
<span id="cb289-7"><a href="#cb289-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-8"><a href="#cb289-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Save text analysis plot</span></span>
<span id="cb289-9"><a href="#cb289-9" aria-hidden="true" tabindex="-1"></a>text_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(social_media, <span class="fu">aes</span>(<span class="at">x =</span> platform, <span class="at">y =</span> engagement)) <span class="sc">+</span>  <span class="co"># create text analysis plot</span></span>
<span id="cb289-10"><a href="#cb289-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb289-11"><a href="#cb289-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Engagement by Platform"</span>)</span>
<span id="cb289-12"><a href="#cb289-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-13"><a href="#cb289-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"engagement_by_platform.png"</span>, <span class="at">plot =</span> text_plot, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>)  <span class="co"># save with custom dimensions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="final-notes" class="level1">
<h1>Final notes</h1>
<p>Your R skills for text analysis will develop as you practice. Text analysis can be challenging because it requires understanding both programming concepts and linguistic patterns. Patience is the key. Many times you will encounter upsetting errors and problems, especially when dealing with messy real-world text data. At these times it is useful to look out for help.</p>
<p>R packages for text analysis have extensive vignettes and documentation. Key packages to explore further include: - <strong>stringr</strong>: for string manipulation and pattern matching - <strong>tidytext</strong>: for tidy text analysis workflows<br>
- <strong>tm</strong>: traditional text mining package - <strong>quanteda</strong>: quantitative analysis of textual data - <strong>textdata</strong>: access to text datasets and sentiment lexicons - <strong>wordcloud</strong>: for creating word clouds - <strong>topicmodels</strong>: for topic modeling</p>
<p>You can access package documentation from the help pages or by simply googling or querying ChatGPT or Claude about different functions.</p>
<p>Keep in mind it is very likely that some other person encountered in the past the same text analysis challenge you are struggling with. You will be surprised about the specificity and variety of the solutions you can find by asking AI, and there is a variety of possibilities for customization of code for a huge variety of tasks and in a diverse and comprehensive collection of coding languages.</p>
</section>
<section id="references" class="level1">
<h1>References</h1>
<p>For further training in text analysis with R, excellent resources include:</p>
<ul>
<li><strong>Text Mining with R</strong> by Julia Silge and David Robinson (free online book)</li>
<li><strong>Quantitative Social Science</strong> by Kosuke Imai (includes text analysis chapters)</li>
<li><strong>An Introduction to Statistical Learning</strong> by James, Witten, Hastie, and Tibshirani</li>
<li>RStudio Education resources and cheat sheets</li>
<li>Various text analysis tutorials and workshops available online</li>
</ul>
<p>Key takeaways from today: - Text data requires special handling and cleaning before analysis - R provides powerful tools for string manipulation and pattern matching - Data frames are ideal for storing text datasets with metadata - Logical expressions are essential for filtering text based on content - The <code>stringr</code> package is indispensable for text processing - Regular expressions (regex) are powerful for pattern matching in text - Statistical analysis and visualization are crucial for understanding text data patterns - ggplot2 provides excellent tools for visualizing text analysis results - Practice with real text data is essential for mastering these skills</p>
<p>Wish you all best of luck with your text analysis journey!</p>
<p>This intro to R walkthrough has benefited from tutorials written by Mehmet Arslan for the Essex Summer School in 2022. All errors are mine.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>